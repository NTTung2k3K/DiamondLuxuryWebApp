@using DiamondLuxurySolution.Data.Entities
@using DiamondLuxurySolution.ViewModel.Common
@using DiamondLuxurySolution.ViewModel.Models.Product

@model List<ProductVm>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>



<!-- Breadcumb area Start -->
<div class="breadcrumb-area">
	<div class="container">
		<div class="row">
			<div class="col-12 text-center">
				<h1 class="page-title">Trang Sức Kim Cương</h1>
				<ul class="breadcrumb justify-content-center">
					<li><a href="/Home/Index">Trang Chủ</a></li>
					<li class="current"><a href="/DiamondJewelry/Index">Trang Sức Kim Cương</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- Breadcumb area End -->
<!-- Main Content Wrapper Start -->
<div class="main-content-wrapper">
	<div class="shop-area pt--40 pb--80 pt-md--30 pb-md--60">
		<div class="container">
			<div class="row" style="justify-content: center;">
				<div class="col-lg-12">
					<div class="row">
						<div class="col-12">
							<!-- Refine Search Start -->
							<style>
								.refine-search {
									display: flex;
									justify-content: center;
									align-items: center;
								}

								.link-border {
									border: 1px solid #ffffff;
									padding: 10px;
									text-decoration: none;
									margin: 5px;
								}

								.nice-select {
									width: 250px;
									display: inline-block;
									padding-top: 5px;
								}

									.nice-select option {
										padding: 10px;
										font-size: 16px;
										width: 250px;
									}

								.pagination-wrap {
									display: flex;
									justify-content: center;
									align-items: center;
								}

								#seeMoreBtn {
									background-color: transparent;
									border: 1px solid white; /* Border color */
									color: white; /* Text color */
									cursor: pointer;
									border-radius: 10px;
									transition: all 0.3s ease;
								}

									#seeMoreBtn:hover {
										background-color: #a8741a; /* Hover background color */
										color: #ffffff; /* Hover text color */
									}

								.hidden {
									display: none !important;
								}
							</style>
							<div class="refine-search mb--30">
								<div class="cat-list-wrapper">
									<!-- Thêm div bao bọc -->
									<ul class="cat-list mb--20">
										<a href="/TSKC_NhanNam/Index" class="link-border">Nhẫn Kim Cương Nam</a>
										<a href="/TSKC_NhanNu/Index" class="link-border">Nhẫn Kim Cương Nữ</a>
										<a href="/TSKC_VongTay/Index" class="link-border">Vòng Tay Kim Cương</a>
										<a href="/TSKC_LacTay/Index" class="link-border">Lắc Tay Kim Cương</a>
										<a href="/TSKC_HoaTai/Index" class="link-border">Hoa Tai Kim Cương</a>
										<a href="/TSKC_DayChuyen/Index" class="link-border">Mặt Dây Chuyền Kim Cương</a>
									</ul>
								</div>
							</div>


							<!-- Refine Search End -->
							<!-- Shop Toolbar Start -->
							<div class="shop-toolbar col-md-12">
								<div class="product-short" style="width: 250px; text-align-last: center; display: flex; align-items: center; justify-content: center;">
									<div class="product-short" style="width: 250px; text-align-last: center; display: flex; align-items: center; justify-content: center;">
										<select id="gemFilter" class=" nice-select">
											<option value="">Đá Đính Kèm</option>
											<option value="Kim Cương">Kim Cương</option>
											<option value="Đá CZ">Đá CZ</option>
											<option value="Đá Ruby">Đá Ruby</option>
											<option value="Đá Sapphire">Đá Sapphire</option>
										</select>
									</div>
								</div>
								<div class="product-short" style="width: 250px; text-align-last: center; display: flex; align-items: center; justify-content: center;">
									<select id="genderFilter" class="nice-select">
										<option value="">Giới Tính</option>
										<option value="Nam">Nam</option>
										<option value="Nữ">Nữ</option>
									</select>
								</div>
								<div class="product-short" style="width: 250px; text-align-last: center; display: flex; align-items: center; justify-content: center;">
									<select id="priceFilter" class="nice-select">
										<option value="">Giá</option>
										<option value="10000000">Dưới 10,000,000</option>
										<option value="10000000-30000000">10,000,000-30,000,000</option>
										<option value="30000000-50000000">30,000,000-50,000,000</option>
										<option value="50000000-100000000">50,000,000-100,000,000</option>
										<option value="100000000">Trên 100,000,000</option>
									</select>
								</div>
							</div>
							<!-- Shop Toolbar End -->
						</div>
					</div>

					<!-- Main Shop wrapper Start -->
					<div class="shop-product-wrap grid gridview-4 row no-gutters col-md-12">
						@if (Model != null)
						{
							var initialProducts = Model.Where(p => p.IsSale).Take(20).ToList();
							var hiddenProducts = Model.Where(p => p.IsSale).Skip(20).ToList();

							@foreach (var product in initialProducts)
							{
								<div class="col-xl-3 col-lg-4 col-md-6 col-12 product-item" data-gem="@product.GemVm.GemName" data-gender="@product.CategoryVm?.CategoryType" data-price="@product.SellingPrice">
									<div class="mirora-product mb-md--10">
										<a href="/DiamondJewelry/Detail?ProductId=@product.ProductId">
											<div class="product-img">
												<img src="@product.ProductThumbnail" alt="@product.ProductName" class="primary-image" style="height: 220px;" />
												<div class="product-img-overlay">
													@if (product.IsSale && product.PercentSale != 0)
													{
														<span class="product-label discount">
															-@product.PercentSale%
														</span>
													}
												</div>
											</div>
											<div class="product-content text-center">
												<span>@product.CategoryVm?.CategoryName</span>
												<h4>@product.ProductName</h4>
												<div class="product-price-wrapper">
													<span class="money">@product.SellingPrice.ToString("N0")</span>
													@if (product.OriginalPrice != product.SellingPrice)
													{
														<span class="product-price-old">
															<span class="money">@product.OriginalPrice.ToString("N0")</span>
														</span>
													}
												</div>
											</div>
										</a>
									</div>
								</div>
							}

							<!-- Hidden products to be shown on "See More" click -->
							@foreach (var product in hiddenProducts)
							{
								<div class="col-xl-3 col-lg-4 col-md-6 col-12 product-item hidden" data-gem="@product.GemVm.GemName" data-gender="@product.CategoryVm?.CategoryType" data-price="@product.SellingPrice">
									<div class="mirora-product mb-md--10">
										<a href="productDetail.html?id=@product.ProductId">
											<div class="product-img">
												<img src="@product.ProductThumbnail" alt="@product.ProductName" class="primary-image" style="height: 220px;" />
												<div class="product-img-overlay">
													@if (product.IsSale && product.PercentSale != 0)
													{
														<span class="product-label discount">
															-@product.PercentSale%
														</span>
													}
												</div>
											</div>
											<div class="product-content text-center">
												<span>@product.CategoryVm?.CategoryName</span>
												<h4>@product.ProductName</h4>
												<div class="product-price-wrapper">
													<span class="money">@product.SellingPrice.ToString("N0")</span>
													@if (product.OriginalPrice != product.SellingPrice)
													{
														<span class="product-price-old">
															<span class="money">@product.OriginalPrice.ToString("N0")</span>
														</span>
													}
												</div>
											</div>
										</a>
									</div>
								</div>
							}
						}
						else
						{
							<p>Không có sản phẩm nào để hiển thị.</p>
						}
					</div>
					<!-- Main Shop wrapper End -->
					<!-- "See More" Button -->
					@if (Model.Count > 20)
					{
						<div class="see-more-wrapper text-center mt-4">
							<button id="seeMoreBtn" class="btn btn-primary">Xem thêm</button>
						</div>
					}
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Main Content Wrapper End -->
<!-- Include jQuery -->
<script>

	$(document).ready(function () {
		$('#seeMoreBtn').on('click', function () {
			$('.product-item.hidden').slice(0, 20).removeClass('hidden');
			if ($('.product-item.hidden').length == 0) {
				$('#seeMoreBtn').hide();
			}
		});

		function filterProducts() {
			var gender = $('#genderFilter').val().toLowerCase();
			var price = $('#priceFilter').val();
			var gem = $('#gemFilter').val().toLowerCase();

			$('.product-item').each(function () {
				var productGender = $(this).data('gender').toLowerCase();
				var productPrice = parseFloat($(this).data('price'));
				var productGem = $(this).data('gem').toLowerCase();

				var showProduct = true;

				if (gender && productGender !== gender) {
					showProduct = false;
				}

				if (price) {
					if (price === '10000000') { // Dưới 10,000,000
						if (productPrice >= 10000000) {
							showProduct = false;
						}
					} else if (price === '100000000') { // Trên 100,000,000
						if (productPrice <= 100000000) {
							showProduct = false;
						}
					} else {
						var priceRange = price.split('-');
						if (priceRange.length === 2) {
							var minPrice = parseFloat(priceRange[0]);
							var maxPrice = parseFloat(priceRange[1]);
							if (productPrice < minPrice || productPrice > maxPrice) {
								showProduct = false;
							}
						}
					}
				}

				if (gem && productGem !== gem) {
					showProduct = false;
				}

				if (showProduct) {
					$(this).fadeIn();
				} else {
					$(this).fadeOut();
				}
			});

			if ($('.product-item.hidden').length > 0) {
				$('#seeMoreBtn').show();
			} else {
				$('#seeMoreBtn').hide();
			}
		}

		$('#gemFilter, #genderFilter, #priceFilter').on('change', function () {
			filterProducts();
		});

		filterProducts();
	});
</script>



